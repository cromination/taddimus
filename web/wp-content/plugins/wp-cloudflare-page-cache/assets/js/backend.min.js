"use strict";let swcfpc_toolbar_cache_status_tries=0,swcfpc_toolbar_cache_status_interval=null;const spcAjaxURL=window.swcfpcOptions.ajaxUrl;let spcCacheEnabled=parseInt(window.swcfpcOptions.cacheEnabled);const spcAjaxNonce=window.swcfpcOptions.nonce;function swcfpc_lock_screen(){if(!document.querySelector(".swcfpc_please_wait")){let e=document.querySelectorAll("input[type=submit]"),c=document.querySelectorAll("input[type=submit]"),s=document.querySelectorAll("a");e.forEach(e=>{e.classList.add("swcfpc_hide")}),c.forEach(e=>{e.classList.add("swcfpc_hide")}),s.forEach(e=>{e.classList.add("swcfpc_hide")});let t=document.createElement("div");t.classList.add("swcfpc_please_wait"),document.body.prepend(t)}}function swcfpc_unlock_screen(){let e=document.querySelectorAll("input[type=submit]"),c=document.querySelectorAll("input[type=submit]"),s=document.querySelectorAll("a");e.forEach(e=>{e.classList.remove("swcfpc_hide")}),c.forEach(e=>{e.classList.remove("swcfpc_hide")}),s.forEach(e=>{e.classList.remove("swcfpc_hide")}),document.querySelector(".swcfpc_please_wait").remove()}function swcfpc_display_ok_dialog(e,c,s,t,r,a,l,o,n){s=void 0===s||null==s?350:parseInt(s),t=void 0===t||null==t?300:parseInt(t),a=void 0===a?null:a,l=void 0===l?"Close":l,n=void 0===n?null:n;let i="success";"warning"===(r=void 0===r?null:r)?i="warning":"error"===r?i="error":"info"===r?i="info":"question"===r&&(i="question"),null==(o=void 0===o?null:o)?Swal.fire({title:null!==a?a:"",html:c,icon:i,confirmButtonText:l}):Swal.fire({title:null!==a?a:"",html:c,icon:i,confirmButtonText:l,willClose(){null!=n?o(n):o()}}).then(e=>{e.isConfirmed&&(null!=n?o(n):o())})}async function swcfpc_force_purge_everything(){try{swcfpc_lock_screen();let e=await window.fetch(spcAjaxURL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:`action=swcfpc_purge_everything&security=${spcAjaxNonce}`,credentials:"same-origin",timeout:1e4});if(e.ok){let c=await e.json();swcfpc_unlock_screen(),"ok"===c.status?swcfpc_display_ok_dialog("Success",`${c.success_msg}`,null,null,"success"):swcfpc_display_ok_dialog("Error",`${c.error}`,null,null,"error")}else console.error(`Error: ${e.status} ${e.statusText}`),swcfpc_unlock_screen()}catch(s){window.alert(`Error: ${s.status} ${s.message}`),console.error(s),swcfpc_unlock_screen()}}async function swcfpc_purge_whole_cache(){try{swcfpc_lock_screen();let e=await window.fetch(spcAjaxURL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:`action=swcfpc_purge_whole_cache&security=${spcAjaxNonce}`,credentials:"same-origin",timeout:1e4});if(e.ok){let c=await e.json();swcfpc_unlock_screen(),"ok"===c.status?swcfpc_display_ok_dialog("Success",`${c.success_msg}`,null,null,"success"):swcfpc_display_ok_dialog("Error",`${c.error}`,null,null,"error")}else console.error(`Error: ${e.status} ${e.statusText}`),swcfpc_unlock_screen()}catch(s){window.alert(`Error: ${s.status} ${s.message}`),console.error(s),swcfpc_unlock_screen()}}async function swcfpc_purge_single_post_cache(e){try{let c=encodeURIComponent(JSON.stringify({post_id:e}));swcfpc_lock_screen();let s=await window.fetch(spcAjaxURL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:`action=swcfpc_purge_single_post_cache&security=${spcAjaxNonce}&data=${c}`,credentials:"same-origin",timeout:1e4});if(s.ok){let t=await s.json();swcfpc_unlock_screen(),"ok"===t.status?swcfpc_display_ok_dialog("Success",`${t.success_msg}`,null,null,"success"):swcfpc_display_ok_dialog("Error",`${t.error}`,null,null,"error")}else console.error(`Error: ${s.status} ${s.statusText}`),swcfpc_unlock_screen()}catch(r){window.alert(`Error: ${r.status} ${r.message}`),console.error(r),swcfpc_unlock_screen()}}function swcfpc_update_toolbar_cache_status(){let e=document.getElementById("wp-admin-bar-wp-cloudflare-super-page-cache-toolbar-container");if(e){0==spcCacheEnabled?(e.classList.remove("bullet-green"),e.classList.add("bullet-red")):(e.classList.remove("bullet-red"),e.classList.add("bullet-green")),window.clearInterval(swcfpc_toolbar_cache_status_interval),swcfpc_toolbar_cache_status_interval=null;return}swcfpc_toolbar_cache_status_tries++}document.addEventListener("DOMContentLoaded",()=>{try{spcCacheEnabled=void 0===spcCacheEnabled?0:spcCacheEnabled,document.querySelector("#wp-admin-bar-wp-cloudflare-super-page-cache-toolbar-purge-all a")?.addEventListener("click",e=>{e.preventDefault(),swcfpc_purge_whole_cache()}),document.querySelector("#wp-admin-bar-wp-cloudflare-super-page-cache-toolbar-purge-single a")?.addEventListener("click",e=>{e.preventDefault(),swcfpc_purge_single_post_cache(e.target.hash.replace("#",""))}),document.querySelector("#wp-admin-bar-wp-cloudflare-super-page-cache-toolbar-force-purge-everything a")?.addEventListener("click",e=>{e.preventDefault(),swcfpc_force_purge_everything()}),document.querySelectorAll(".swcfpc_action_row_single_post_cache_purge").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),swcfpc_purge_single_post_cache(e.target.dataset.post_id)})}),swcfpc_toolbar_cache_status_interval=window.setInterval(swcfpc_update_toolbar_cache_status,2e3)}catch(e){console.warn(e)}});