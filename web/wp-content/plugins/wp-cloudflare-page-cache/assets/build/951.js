"use strict";(globalThis.webpackChunkwp_cloudflare_page_cache=globalThis.webpackChunkwp_cloudflare_page_cache||[]).push([[951],{1951:(e,a,t)=>{t.r(a),t.d(a,{default:()=>h});var r=t(1609),o=t(5975),s=t(8018),n=t(6087),l=t(7723),c=t(9407);const i=(0,c.A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),d=(0,c.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var u=t(4721);const h=()=>{const{closeModal:e,resetAssets:a,assets:t,asyncLocked:c,lockAsync:h,changesToSave:p}=(0,s.a)(),{availableContexts:g,api:v,nonce:b}=window.SPCAssetManager,{locationContexts:f,userStateContexts:w}=g,[m,y]=(0,n.useState)(!1),_=()=>{const e=new URL(window.location.href);e.search="",window.history.replaceState({},"",e.href),window.location.reload()};return(0,r.createElement)("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 bg-gray-50 relative gap-3"},(0,r.createElement)(o.A,{variant:"outline",icon:i,onClick:()=>{a(),u.oR.success((0,l.__)("All assets have been reset to enabled state.","wp-cloudflare-page-cache"),{description:(0,l.__)("You can now select the contexts you want to disable.","wp-cloudflare-page-cache")})},disabled:c,className:"rounded-lg py-1 px-3"},(0,l.__)("Enable All (Reset)","wp-cloudflare-page-cache")),(0,r.createElement)(o.A,{variant:"outline",className:"ml-auto rounded-lg py-1 px-3",onClick:e,disabled:c},(0,l.__)("Cancel","wp-cloudflare-page-cache")),(0,r.createElement)(o.A,{variant:"cta",className:"shadow-none hover:shadow-none rounded-lg py-1 px-3",onClick:async()=>{h(!0),y(!0);const e={},a=[...f,...w],r=Object.values(t).flat();if(Object.entries(p).forEach((([t,o])=>{const s=r.find((e=>e.asset_hash===t));s&&(e[t]={rules:{}},Object.entries(o).forEach((([r,o])=>{const s=a.find((e=>e.key===r));s&&s.saveAs&&(e[t].rules[s.saveAs]=o)})),e[t]?.rules&&(e[t]={...e[t],asset_name:s.name,asset_type:s.asset_type,origin_type:s.origin_type,asset_url:s.asset_url}))})),0===Object.keys(e).length)return u.oR.error((0,l.__)("No changes to save.","wp-cloudflare-page-cache")),y(!1),void h(!1);const o=JSON.stringify({assets_data:e});try{const e=await fetch(`${v}/assets/save-rules`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":b},body:o}),a=await e.json();if(!a.success){const e=a.data||(0,l.__)("Unknown error occurred.","wp-cloudflare-page-cache");return u.oR.error((0,l.__)("Failed to save asset rules.","wp-cloudflare-page-cache"),{description:e}),void h(!1)}u.oR.success(a.message,{description:(0,l.__)("Please wait, the page will reload soon.","wp-cloudflare-page-cache"),action:{label:(0,l.__)("Reload Now","wp-cloudflare-page-cache"),onClick:_}}),setTimeout(_,3e3)}catch(e){u.oR.error((0,l.__)("Failed to save asset rules.","wp-cloudflare-page-cache"),{description:e.message}),h(!1)}finally{y(!1)}},disabled:c,icon:d,loader:m},c?(0,l.__)("Saving","wp-cloudflare-page-cache")+"...":(0,l.__)("Save Changes","wp-cloudflare-page-cache")))}},2732:(e,a,t)=>{t.d(a,{F:()=>n});var r=t(4164);const o=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=r.$,n=(e,a)=>t=>{var r;if(null==(null==a?void 0:a.variants))return s(e,null==t?void 0:t.class,null==t?void 0:t.className);const{variants:n,defaultVariants:l}=a,c=Object.keys(n).map((e=>{const a=null==t?void 0:t[e],r=null==l?void 0:l[e];if(null===a)return null;const s=o(a)||o(r);return n[e][s]})),i=t&&Object.entries(t).reduce(((e,a)=>{let[t,r]=a;return void 0===r||(e[t]=r),e}),{}),d=null==a||null===(r=a.compoundVariants)||void 0===r?void 0:r.reduce(((e,a)=>{let{class:t,className:r,...o}=a;return Object.entries(o).every((e=>{let[a,t]=e;return Array.isArray(t)?t.includes({...l,...i}[a]):{...l,...i}[a]===t}))?[...e,t,r]:e}),[]);return s(e,c,d,null==t?void 0:t.class,null==t?void 0:t.className)}},5975:(e,a,t)=>{t.d(a,{A:()=>i});var r=t(1609),o=t(2732),s=t(2748),n=t(8723);const l=(0,o.F)("border inline-flex items-center justify-center gap-2 rounded font-medium transition-all cursor-pointer disabled:cursor-not-allowed disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0",{variants:{variant:{default:"border-primary bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",destructive:"border-destructive bg-destructive text-white shadow-sm hover:bg-destructive/90",outline:"border-current/25 text-foreground/80 hover:bg-accent hover:text-accent-foreground",ghost:"border-transparent hover:bg-accent text-secondary-foreground hover:text-accent-foreground",link:"border-transparent text-primary underline-offset-4 hover:underline",cta:"border-transparent bg-gradient-to-r from-orange-500 to-orange-600 text-white shadow-lg hover:shadow-xl shadow-orange-200 dark:shadow-orange-900 dark:hover:shadow-orange-800 bg-size-[100%] hover:bg-size-[150%] duration-300 ease-in-out",orange:"border-orange-600 bg-orange-600 text-white hover:bg-orange-700",green:"border-green-600 bg-green-600 text-white shadow-sm hover:bg-green-700",blue:"border-blue-600 bg-blue-600 text-white hover:bg-blue-700",upsell:"bg-gradient-to-r from-orange-500 to-red-500 shadow-md hover:shadow-lg bg-size-[100%] hover:bg-size-[150%] text-white"},size:{default:"h-10 px-6 py-3 text-sm",sm:"h-8 px-4 py-2 text-sm",lg:"h-12 px-6 py-3 text-base font-semibold",xs:"h-auto px-3 py-1.5 text-xs gap-1",icon:"size-9 p-1.5"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((({className:e,variant:a,size:t,loader:o=!1,icon:c,href:i,target:d,children:u,onClick:h,...p},g)=>{const v=i?"a":"button",b=i?{href:i,target:d,rel:"noreferrer",...p}:{onClick:h,...p};return(0,r.createElement)(v,{ref:g,className:(0,s.cn)(l({variant:a,size:t,className:e})),...b},c&&!o&&(0,r.createElement)(c,null),o&&(0,r.createElement)(n.A,{className:"animate-spin"}),u)}));c.displayName="Button";const i=c},8723:(e,a,t)=>{t.d(a,{A:()=>r});const r=(0,t(9407).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}}]);